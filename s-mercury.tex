\startenvironment *
\setuppapersize[S6]

\setuplayout
    [
  	cutspace=0mm,
  	leftmargin=6mm,
  	leftmargindistance=2mm,
  	width=middle,
 	rightmargindistance=2mm,
	rightmargin=6mm,
	backspace=8mm,
	%
	header=20mm,
	topspace=1mm,
	height=middle,
	headerdistance=5mm,
	footerdistance=2mm,
	footer=6mm
]

% Setting up the fonts
\definefontfamily [presentation] [serif] [Palatino]
\definefontfamily [presentation] [sans] [Diavlo] 
\definefontfamily [presentation] [mono] [Roboto Light]
\definefontfamily [presentation] [math] [Euler]
\setupbodyfont[presentation,18pt]

\setupbodyfontenvironment[default][em=bold]  % Trying to make em colored but using the \color command doesn't work


%The title of the slides. I couldn't figure out a way to make it centered and positionned correctly and be a two-liner. This is a temporary workaround I hope
\setupheadertexts [\hpos{titles}{%
	\bTABLE[frame=no,align=middle,offset=0.05cm]
		\bTR \bTDÂ \color[title]{\getmarking [slide]} \eTD \eTR
		\bTR \bTD \color[subtitle]{\tfx\getmarking [subtitle]} \eTD \eTR
	\eTABLE
}]
\setupheader[text][style=\sc\ss\tfb]


\setupfooter[text][style=\tt\tfxx]
\setupfootertexts[\setups{metadata}][\userpagenumber/\lastuserpage]
\startsetups metadata
  \getvariable{metadata}{title}
\stopsetups


%Defining the slide
\definehead[slide] [subject][
	page=yes,
	placehead=empty,
	insidesection=\doSubtitle,
]
\definemarking[subtitle]
\starttexdefinition doSubtitle
  \marking [subtitle] {\structureuservariable{subtitle}}
\stoptexdefinition

\definecolor[background][h=002b36]
\definecolor[foreground][h=c8d6ac]
\definecolor[title] [h=1f98a4]
\definecolor[subtitle] [h=65b583]


\startMPpositiongraphic {drawings}
StartPage;
    numeric w; w=\MPw{\MPvar{self}} ;
	fill Page withcolor \MPcolor{background};
	%Drawing the bottom lines
	path a ;
	a:=((0,0) -- for i=1cm step 1cm until PaperWidth-1cm : (i,uniformdeviate(0.7cm)) -- endfor  (PaperWidth,0)) shifted (0,1cm);
	drawpath a withcolor \MPcolor{title} withpen pencircle scaled 0.3mm;
	path b ;
	b:=((0,0) -- for i=1cm step 1cm until PaperWidth-1cm : (i,uniformdeviate(0.7cm)) -- endfor  (PaperWidth,0)) shifted (0,1cm);
	drawpath b withcolor \MPcolor{subtitle} withpen pencircle scaled 0.3mm;
	path c ;
	%Drawing the top lines. The variable w should be the max of the widths of the title and subtitle. So basically the width of the natural table containing them
	c:=((0,0) -- for i=1cm step 1cm until PaperWidth/2-w/2-1cm : (i,-uniformdeviate(0.7cm)) -- endfor (PaperWidth/2-w/2,-0.5cm) -- (PaperWidth/2+w/2,-0.5cm) -- for i=PaperWidth/2+w/2+1cm step 1cm until PaperWidth-1cm : (i,-uniformdeviate(0.7cm)) -- endfor (PaperWidth,0)) shifted (0,PaperHeight-1cm);
	drawpath c withcolor \MPcolor{subtitle} withpen pencircle scaled 0.3mm;
	path d ;
	d:=((0,0) -- for i=1cm step 1cm until PaperWidth/2-w/2-1cm : (i,-uniformdeviate(0.7cm)) -- endfor (PaperWidth/2-w/2,-0.5cm) -- (PaperWidth/2+w/2,-0.5cm) -- for i=PaperWidth/2+w/2+1cm step 1cm until PaperWidth-1cm : (i,-uniformdeviate(0.7cm)) -- endfor (PaperWidth,0)) shifted (0,PaperHeight-1cm);
	drawpath d withcolor \MPcolor{title} withpen pencircle scaled 0.3mm;
StopPage;
\stopMPpositiongraphic

\startpositionoverlay{page:background}
    \setMPpositiongraphic{titles}{drawings}{self=titles}
\stoppositionoverlay

\defineoverlay [page:background][\positionoverlay{page:background}]
\setupbackgrounds[page][background={page:background}]

\setupcolors[state=start,textcolor=foreground] % Setting text color to a light yellow

\define[1]\em{\bf\color[title]{#1}}

%\showframe
\stopenvironment
